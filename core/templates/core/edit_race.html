{% extends "base.html" %}
{% load static from staticfiles %} 


{% block head_extra %}
<script type="text/javascript" src="{% static "js/create.js" %}"></script>
<script type="text/javascript">
    var wizard_step = "{{ wizard.steps.current }}";
</script>
{% endblock %}

{% block content %}
<div class="content">
    <div class="container update">
        <h1>f:Modification de course</h1>
        <h2> 
        {% if wizard.steps.current == 'race' %}
        Général
        {% elif wizard.steps.current == 'location' %}
        Lieu
        {% else %}
        Contact
        {% endif %} 

        ( {{wizard.steps.step1 }} / {{ wizard.steps.count }} )</h2>

        <form autocomplete="off"  action="" method="post" class="form-horizontal" id="edit-form">
            
            {% csrf_token %}

            <!-- fake fields are a workaround for chrome autofill getting the wrong fields -->
            <input autocomplete="false" name="hidden" type="text" style="display:none;">

            {# display location search box only for location form #}
            {% if wizard.steps.current == 'location' %}
            <div class='location-searchbox'>
                <div class="row">
                    <div class="col-sm-2">
                        <label for="autocompleteInput" class="location-searchbox-label">Rechercher une adresse :</label>
                    </div>
                    <div class="col-sm-8">
                        <input id="autocompleteInput" class="form-control" placeholder="Entrer une adresse pour remplir automatiquement le formulaire" onFocus="geolocate()" type="text" name="location-searchbox" onkeypress="return event.keyCode != 13;"></input>
                    </div>
                </div>
                <div class="row">
                    <div class="col-sm-8 col-sm-offset-2 map-container" >
                        <div id="address-map"></div>
                    </div>
                </div>

            </div>
            {% endif %}


            {{ wizard.management_form }}

            {% if wizard.form.forms %}
        
                {{ wizard.form.management_form }}
        
                {% for form in wizard.form.forms %}

                    {# Include the hidden fields #}
                    {% for hidden in form.hidden_fields %}
                    {{ hidden }}
                    {% endfor %}

                    {% for field in form.visible_fields %}
                        <div class="form-group">
                            {{ field.errors }}
                            {{ field.label_tag }}
                            {{ field }}
                        </div>
                    {% endfor %}
                {% endfor %}

            {% else %}

                {# Include the hidden fields #}
                {% for hidden in form.hidden_fields %}
                {{ hidden }}
                {% endfor %}

                {% for field in wizard.form.visible_fields %}
                    <div class="form-group">
                        {{ field.errors }}
                        <div class="col-sm-2">{{ field.label_tag }}</div>
                        <div class="col-sm-8">{{ field }}</div>
                    </div>
                {% endfor %}
            {% endif %}

            <div class="form-submit">
                <a href="{% url "update_event" event_pk %}" class="btn btn-info" role="button">Annuler</a>
                {% if wizard.steps.prev %}
                    <button name="wizard_goto_step" type="submit" class="btn btn-default" value="{{ wizard.steps.first }}"><< Début</button>
                    <button name="wizard_goto_step" type="submit" class="btn btn-default" value="{{ wizard.steps.prev }}">< Précédent</button>
                {% endif %}
                {% if wizard.steps.next %}
                    <button type="submit" class="btn btn-default"/>Suivant ></button>
                {% else %}
                    <button type="submit" class="btn btn-primary"/>Envoyer</button>
                {% endif %}
            </div>
        </form>
    </div>
</div>



{% endblock %}